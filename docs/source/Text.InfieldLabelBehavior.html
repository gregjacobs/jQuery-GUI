<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js">/*global define */
define( [
	'jquery',
	'lodash',
	'jqc/form/field/Text.Behavior'
], function( jQuery, _, TextFieldBehavior ) {
	
<span id='jqc-form-field-Text-InfieldLabelBehavior'>	/**
</span>	 * @class jqc.form.field.Text.InfieldLabelBehavior
	 * @extends jqc.form.field.Text.Behavior
	 * 
	 * Handles a {@link jqc.form.field.Text TextField} when it is in the &quot;infield label&quot; state (i.e. it is displaying a label that
	 * is shown inside the field itself).  This is opposed to when it is using the {@link jqc.form.field.Text.EmptyTextBehavior EmptyTextBehavior}, 
	 * which is incompatible with the field having an &quot;infield&quot; label.
	 * 
	 * This implementation is based off of the jquery.infield labels plugin. http://fuelyourcoding.com/scripts/infield/
	 */
	var InfieldLabelBehavior = TextFieldBehavior.extend( {
		
<span id='jqc-form-field-Text-InfieldLabelBehavior-cfg-fadeOpacity'>		/**
</span>		 * @cfg {Number} fadeOpacity
		 * Once the field has focus, how transparent should the label be.
		 * Should be a number between 0 and 1. Defaults to 0.5.
		 */
		fadeOpacity : 0.5, 
		
<span id='jqc-form-field-Text-InfieldLabelBehavior-cfg-fadeDuration'>		/**
</span>		 * @cfg {Number} fadeDuration
		 * The duration (in milliseconds) to fade the label element. Defaults to 300.
		 */
		fadeDuration : 300,
		
		
<span id='jqc-form-field-Text-InfieldLabelBehavior-property-labelShown'>		/**
</span>		 * Flag to store whether the label is currently shown or not.
		 *
		 * @private 
		 * @property labelShown
		 * @type Boolean
		 */
		labelShown : true,
		
		
<span id='jqc-form-field-Text-InfieldLabelBehavior-method-onRender'>		/**
</span>		 * Called when the TextField is rendered.
		 * 
		 * @param {jqc.form.field.Text} textField
		 */
		onRender : function( textField ) {
			// &quot;infield&quot; labels move the label element into the input container. It is absolutely positioned from there.
			var $labelEl = textField.getLabelEl();
			$labelEl.bind( 'click', function() { textField.focus(); } );  // when clicked, we want to focus the text field
			textField.getInputContainerEl().append( $labelEl );
			
			textField.getInputEl().attr( 'autocomplete', 'false' );  // set autocomplete=&quot;false&quot; on the field to fix issues with browser autocomplete and &quot;infield&quot; labels
			
			this.checkForEmpty( textField );
		},
		
		
<span id='jqc-form-field-Text-InfieldLabelBehavior-method-onSetValue'>		/**
</span>		 * Called when the TextField's setValue() method is called (if the TextField is rendered)
		 * 
		 * @param {jqc.form.field.Text} textField
		 * @param {String} value
		 */
		onSetValue : function( textField, value ) {
			if( textField.rendered ) {
				this.checkForEmpty( textField );
			}
		},
		
		
<span id='jqc-form-field-Text-InfieldLabelBehavior-method-onChange'>		/**
</span>		 * Called when the TextField has been changed.
		 * 
		 * @param {jqc.form.field.Text} textField
		 */
		onChange : function( textField ) {
			if( textField.rendered ) {
				this.checkForEmpty( textField );
			}
		},
		
		
<span id='jqc-form-field-Text-InfieldLabelBehavior-method-onFocus'>		/**
</span>		 * Called when the TextField has been focused.
		 * 
		 * @param {jqc.form.field.Text} textField
		 */
		onFocus : function( textField ) {
			// If the label is currently shown, fade it to the fadeOpacity config
			if( textField.rendered &amp;&amp; this.labelShown ) {
				this.setLabelOpacity( textField.getLabelEl(), this.fadeOpacity ); 
			}
		},
		
		
<span id='jqc-form-field-Text-InfieldLabelBehavior-method-onBlur'>		/**
</span>		 * Called when the TextField has been blurred.
		 * 
		 * @param {jqc.form.field.Text} textField
		 */
		onBlur : function( textField ) {
			if( textField.rendered ) {
				this.checkForEmpty( textField );
			}
		},
		
		
<span id='jqc-form-field-Text-InfieldLabelBehavior-method-onKeyDown'>		/**
</span>		 * Called when the TextField gets a keydown event.
		 * 
		 * @param {jqc.form.field.Text} textField
		 * @param {jQuery.Event} evt The jQuery event object for the event.
		 */
		onKeyDown : function( textField, evt ) {
			if( textField.rendered ) {
				// Skip Shift and Tab keydowns
				if( evt.keyCode === 16 || evt.keyCode === 9 ) {
					return;
				}
				
				if( this.labelShown ) {
					textField.getLabelEl().hide();
					this.labelShown = false;
				}
			}
		},
		
		
		// ------------------------------
		
		
<span id='jqc-form-field-Text-InfieldLabelBehavior-method-setLabelOpacity'>		/**
</span>		 * Animates the label element's opacity of the TextField to the provided `opacity`.
		 * 
		 * @private
		 * @param {jQuery} $labelEl The label element.
		 * @param {Number} opacity
		 */
		setLabelOpacity : function( $labelEl, opacity ) {
			$labelEl.stop().animate( { opacity: opacity }, this.fadeDuration );
			this.labelShown = ( opacity &gt; 0.0 );
		},
		
		
<span id='jqc-form-field-Text-InfieldLabelBehavior-method-prepLabelForShow'>		/**
</span>		 * @private
		 * @param {jQuery} $labelEl The label element.
		 */
		prepLabelForShow : function( $labelEl ) {
			if( !this.labelShown ) {
				$labelEl.css( { opacity: 0.0 } ).show();
			}
		},
		
		
<span id='jqc-form-field-Text-InfieldLabelBehavior-method-checkForEmpty'>		/**
</span>		 * Checks the TextField to see if it's empty, and if so shows the infield label.
		 * If it's not empty, 
		 * 
		 * @private
		 * @param {jqc.form.field.Text} textField
		 */
		checkForEmpty : function( textField ) {
			var $labelEl = textField.getLabelEl();
			
			if( textField.getValue() === &quot;&quot; ) {
				this.prepLabelForShow( $labelEl );
				this.setLabelOpacity( $labelEl, 1.0 );
			} else {
				this.setLabelOpacity( $labelEl, 0.0 );
			}
		}
	
	} );
	
	return InfieldLabelBehavior;
	
} );
</pre>
</body>
</html>
